<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product - Responsive with Mobile Slider</title>
    <link rel="stylesheet" href="css/index.css" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/Draggable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/InertiaPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/MotionPathPlugin.min.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <h2>Product</h2>

      <!-- ë°ìŠ¤í¬íƒ‘/íƒœë¸”ë¦¿: ì›í˜• íšŒì „ ë ˆì´ì•„ì›ƒ -->
      <div class="container">
        <div class="orbit">
          <svg viewBox="0 0 400 400">
            <path
              stroke-width="1"
              stroke="black"
              id="circle"
              fill="none"
              d="M396,200 C396,308.24781 308.24781,396 200,396 91.75219,396 4,308.24781 4,200 4,91.75219 91.75219,4 200,4 308.24781,4 396,91.75219 396,200 z"
            ></path>
          </svg>
          <div class="image on">
            <img src="img/cpb.png" alt="ì´ˆì½”íŒŒì´ ì°°ë–¡" />
            <div class="info">
              <h3>ì´ˆì½”íŒŒì´ ì°°ë–¡</h3>
              <p>ë‹¬ì½¤í•œ ì´ˆì½œë¦¿ê³¼ ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ì†ì— ì°°ë–¡ì´ ë“¤ì–´ìˆëŠ” ì´ˆì½”íŒŒì´</p>
            </div>
          </div>
          <div class="image">
            <img src="img/rcb.png" alt="ì°°ë–¡ì¿ í‚¤ ì˜¤ë¦¬ì§€ë„" />
            <div class="info">
              <h3>ì°°ë–¡ì¿ í‚¤ ì˜¤ë¦¬ì§€ë„</h3>
              <p>
                ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ ì†ì— ì«€ë“ì«€ë“ ì°°ë–¡ì´ ë“¤ì–´ìˆëŠ” í•œêµ­í˜• í“¨ì „ ì¿ í‚¤
              </p>
            </div>
          </div>
          <div class="image">
            <img src="img/ycb.png" alt="ìœ ìì¹˜ì¦ˆì¼€ì´í¬" />
            <div class="info">
              <h3>ìœ ìì¹˜ì¦ˆì¼€ì´í¬</h3>
              <p>ì¹˜ì¦ˆì¼€ì´í¬ì˜ ë¶€ë“œëŸ¬ìš´ í’ë¯¸ì™€ ìƒí¼í•œ ìœ ì í•„ë§</p>
            </div>
          </div>
          <div class="image">
            <img src="img/cb.png" alt="ì«€ë“ ì´ˆì½”ì¹©" />
            <div class="info">
              <h3>ì«€ë“ ì´ˆì½”ì¹©</h3>
              <p>ì´ˆì½”ì¹©+ì«„ê¹ƒí•œ ë–¡ ì¡°í•©</p>
            </div>
          </div>
          <div class="image">
            <img src="img/hcb.png" alt="ì°°í˜¸ë–¡ì¿ í‚¤" />
            <div class="info">
              <h3>ì°°í˜¸ë–¡ì¿ í‚¤</h3>
              <p>ë‹¬ì½¤í•œ í˜¸ë–¡ë§›ê³¼ ì”¨ì•—ì˜ ì‹ê°</p>
            </div>
          </div>
          <div class="image">
            <img src="img/bb.png" alt="ë¸Œë£¨ëŠì™€" />
            <div class="info">
              <h3>ë¸Œë£¨ëŠì™€</h3>
              <p>í™ˆë©”ì´ë“œí’ ì«€ë“ ë¸Œë¼ìš°ë‹ˆ ì¿ í‚¤</p>
            </div>
          </div>
          <div class="image">
            <img src="img/gpb.png" alt="ê·¸ë‘ì‰˜ íŒŒì¸ì• í”Œ" />
            <div class="info">
              <h3>ê·¸ë‘ì‰˜ íŒŒì¸ì• í”Œ</h3>
              <p>ë‹¬ì½¤ìƒí¼ íŒŒì¸ì• í”Œ ì¼</p>
            </div>
          </div>
          <div class="image">
            <img src="img/fb.png" alt="ì«€ë“ê³¼ì¼ì¹©" />
            <div class="info">
              <h3>ì«€ë“ê³¼ì¼ì¹©</h3>
              <p>ë‹¬ì½¤ìƒì½¤ ê³¼ì¼ì¹© ì½•ì½•</p>
            </div>
          </div>
          <div class="image">
            <img src="img/gsb.png" alt="ê·¸ë‘ì‰˜ ë”¸ê¸°" />
            <div class="info">
              <h3>ê·¸ë‘ì‰˜ ë”¸ê¸°</h3>
              <p>ë”¸ê¸°+ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ ì¡°í•©</p>
            </div>
          </div>
          <div class="image">
            <img src="img/gab.png" alt="ê·¸ë‘ì‰˜ ì‚¬ê³¼" />
            <div class="info">
              <h3>ê·¸ë‘ì‰˜ ì‚¬ê³¼</h3>
              <p>ì‚¬ê³¼ì˜ ìƒí¼í•¨ì´ í†¡í†¡</p>
            </div>
          </div>
        </div>
      </div>

      <!-- ì œí’ˆ í´ë¦­ì‹œ ë‚˜ì˜¤ëŠ” ì¿ í‚¤ ì´ë¯¸ì§€ -->
      <div class="deco">
        <div class="set">
          <div class="left left1 choco">
            <img src="img/cpc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right3 choco">
            <img src="img/cpc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left2 oriC">
            <img src="img/rc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right2 oriC">
            <img src="img/rc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left3 yuzuC">
            <img src="img/ycc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right1 yuzuC">
            <img src="img/ycc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left1 cc">
            <img src="img/cc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right3 cc">
            <img src="img/cc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left2 hd">
            <img src="img/hc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right2 hd">
            <img src="img/hc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left3 br">
            <img src="img/bc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right1 br">
            <img src="img/bc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left1 gp">
            <img src="img/gpc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right3 gp">
            <img src="img/gpc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left2 cf">
            <img src="img/fc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right2 cf">
            <img src="img/fc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left3 gs">
            <img src="img/gsc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right1 gs">
            <img src="img/gsc.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
        <div class="set">
          <div class="left left1 ga">
            <img src="img/gac.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
          <div class="right right3 ga">
            <img src="img/gac.png" alt="ì¿ í‚¤ì´ë¯¸ì§€" />
          </div>
        </div>
      </div>

      <!-- ëª¨ë°”ì¼: ìŠ¬ë¼ì´ë“œ ë ˆì´ì•„ì›ƒ -->
      <div class="mobile-slider">
        <button class="slider-button prev">&#8249;</button>
        <button class="slider-button next">&#8250;</button>

        <div class="slider-wrapper">
          <div class="slide">
            <img src="img/cpb.png" alt="ì´ˆì½”íŒŒì´ ì°°ë–¡" class="slide-image" />
            <div class="slide-info">
              <h3>ì´ˆì½”íŒŒì´ ì°°ë–¡</h3>
              <p>ë‹¬ì½¤í•œ ì´ˆì½œë¦¿ê³¼ ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ì†ì— ì°°ë–¡ì´ ë“¤ì–´ìˆëŠ” ì´ˆì½”íŒŒì´</p>
            </div>
          </div>
          <div class="slide">
            <img
              src="img/rcb.png"
              alt="ì°°ë–¡ì¿ í‚¤ ì˜¤ë¦¬ì§€ë„"
              class="slide-image"
            />
            <div class="slide-info">
              <h3>ì°°ë–¡ì¿ í‚¤ ì˜¤ë¦¬ì§€ë„</h3>
              <p>
                ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ ì†ì— ì«€ë“ì«€ë“ ì°°ë–¡ì´ ë“¤ì–´ìˆëŠ” í•œêµ­í˜• í“¨ì „ ì¿ í‚¤
              </p>
            </div>
          </div>
          <div class="slide">
            <img src="img/ycb.png" alt="ìœ ìì¹˜ì¦ˆì¼€ì´í¬" class="slide-image" />
            <div class="slide-info">
              <h3>ìœ ìì¹˜ì¦ˆì¼€ì´í¬</h3>
              <p>ì¹˜ì¦ˆì¼€ì´í¬ì˜ ë¶€ë“œëŸ¬ìš´ í’ë¯¸ì™€ ìƒí¼í•œ ìœ ì í•„ë§</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/cb.png" alt="ì«€ë“ ì´ˆì½”ì¹©" class="slide-image" />
            <div class="slide-info">
              <h3>ì«€ë“ ì´ˆì½”ì¹©</h3>
              <p>ì´ˆì½”ì¹©+ì«„ê¹ƒí•œ ë–¡ ì¡°í•©</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/hcb.png" alt="ì°°í˜¸ë–¡ì¿ í‚¤" class="slide-image" />
            <div class="slide-info">
              <h3>ì°°í˜¸ë–¡ì¿ í‚¤</h3>
              <p>ë‹¬ì½¤í•œ í˜¸ë–¡ë§›ê³¼ ì”¨ì•—ì˜ ì‹ê°</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/bb.png" alt="ë¸Œë£¨ëŠì™€" class="slide-image" />
            <div class="slide-info">
              <h3>ë¸Œë£¨ëŠì™€</h3>
              <p>í™ˆë©”ì´ë“œí’ ì«€ë“ ë¸Œë¼ìš°ë‹ˆ ì¿ í‚¤</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/gpb.png" alt="ê·¸ë‘ì‰˜ íŒŒì¸ì• í”Œ" class="slide-image" />
            <div class="slide-info">
              <h3>ê·¸ë‘ì‰˜ íŒŒì¸ì• í”Œ</h3>
              <p>ë‹¬ì½¤ìƒí¼ íŒŒì¸ì• í”Œ ì¼</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/fb.png" alt="ì«€ë“ê³¼ì¼ì¹©" class="slide-image" />
            <div class="slide-info">
              <h3>ì«€ë“ê³¼ì¼ì¹©</h3>
              <p>ë‹¬ì½¤ìƒì½¤ ê³¼ì¼ì¹© ì½•ì½•</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/gsb.png" alt="ê·¸ë‘ì‰˜ ë”¸ê¸°" class="slide-image" />
            <div class="slide-info">
              <h3>ê·¸ë‘ì‰˜ ë”¸ê¸°</h3>
              <p>ë”¸ê¸°+ë¶€ë“œëŸ¬ìš´ ì¿ í‚¤ ì¡°í•©</p>
            </div>
          </div>
          <div class="slide">
            <img src="img/gab.png" alt="ê·¸ë‘ì‰˜ ì‚¬ê³¼" class="slide-image" />
            <div class="slide-info">
              <h3>ê·¸ë‘ì‰˜ ì‚¬ê³¼</h3>
              <p>ì‚¬ê³¼ì˜ ìƒí¼í•¨ì´ í†¡í†¡</p>
            </div>
          </div>
        </div>
        <div class="slider-indicators"></div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/Draggable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/InertiaPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/MotionPathPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>

    <script>
      $(function () {
        const $images = $(".image");
        const $sets = $(".deco .set");

        $images.on("click", function (e) {
          e.preventDefault();
          const i = $images.index(this);
          const $target = $sets.eq(i);

          if ($target.is(":visible")) {
            $target.fadeOut(200).removeClass("active");
            $images.removeClass("active");
            return;
          }

          $sets.filter(":visible").hide().removeClass("active");
          $target.fadeIn(200).addClass("active");
          $images.removeClass("active");
          $(this).addClass("active");
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(MotionPathPlugin, Draggable, InertiaPlugin);

        const images = gsap.utils.toArray(".image");
        const container = document.querySelector(".container");
        const orbit = document.querySelector(".orbit");
        const svgPath = document.querySelector("#circle");

        let currentDraggable = null;
        let isInitialized = false;

        // â­ MotionPath ì ìš© í•¨ìˆ˜
        function applyMotionPath() {
          const containerStyle = window.getComputedStyle(container);
          if (containerStyle.display === "none") {
            console.log("âŒ Container ìˆ¨ê¹€ - MotionPath ì ìš© ì•ˆ í•¨");
            orbit.classList.remove("ready");
            isInitialized = false;
            return;
          }

          const bbox = svgPath.getBBox();
          if (bbox.width === 0 || bbox.height === 0) {
            console.log("âŒ SVG í¬ê¸° 0 - ëŒ€ê¸° ì¤‘");
            return;
          }

          console.log(
            "âœ… MotionPath ì ìš© - SVG:",
            bbox.width,
            "x",
            bbox.height
          );

          const path = "#circle";
          gsap.set(images, {
            motionPath: {
              path: path,
              align: path,
              alignOrigin: [0.5, 0.5],
              end: (i) => i / images.length,
              autoRotate: true,
            },
          });

          // â­ MotionPath ì ìš© ì™„ë£Œ í›„ orbit ë³´ì´ê¸°
          setTimeout(() => {
            orbit.classList.add("ready");
            console.log("âœ¨ Orbit í‘œì‹œ ì™„ë£Œ");
          }, 50);

          isInitialized = true;
        }

        // Draggable ìƒì„±
        function initDraggable() {
          if (currentDraggable) {
            currentDraggable.kill();
          }

          currentDraggable = Draggable.create(container, {
            type: "rotation",
            inertia: true,
            throwResistance: 3000,
            edgeResistance: 0.8,
            cursor: "grab",
            onPress() {
              gsap.set(this.target, { cursor: "grabbing" });
            },
            onRelease() {
              gsap.set(this.target, { cursor: "grab" });
            },
          })[0];

          console.log("âœ… Draggable ìƒì„±");
        }

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function initialize() {
          const containerStyle = window.getComputedStyle(container);

          if (containerStyle.display === "none") {
            console.log("ğŸ“± ëª¨ë°”ì¼ - ì´ˆê¸°í™” ì•ˆ í•¨");
            orbit.classList.remove("ready");
            if (currentDraggable) {
              currentDraggable.kill();
              currentDraggable = null;
            }
            gsap.set(images, { clearProps: "all" });
            isInitialized = false;
            return;
          }

          console.log("ğŸ”„ ì´ˆê¸°í™” ì‹œì‘");

          // â­ orbit íˆ¬ëª…í•˜ê²Œ
          orbit.classList.remove("ready");

          // ì´ì „ ìƒíƒœ ì •ë¦¬
          gsap.killTweensOf(images);
          if (currentDraggable) {
            currentDraggable.kill();
            currentDraggable = null;
          }

          // CSS ì „í™˜ ì™„ë£Œ ëŒ€ê¸° í›„ ì ìš©
          setTimeout(() => {
            applyMotionPath();
            if (isInitialized) {
              initDraggable();
            }
          }, 100);
        }

        // ResizeObserverë¡œ container í¬ê¸° ë³€í™” ê°ì§€
        const resizeObserver = new ResizeObserver((entries) => {
          for (const entry of entries) {
            const { width, height } = entry.contentRect;
            console.log("ğŸ“ í¬ê¸° ë³€í™”:", width, "x", height);

            if (width > 0 && height > 0) {
              setTimeout(() => {
                initialize();
              }, 150);
            } else {
              // í¬ê¸°ê°€ 0ì´ë©´ orbit ìˆ¨ê¹€
              orbit.classList.remove("ready");
            }
          }
        });

        resizeObserver.observe(container);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        initialize();

        // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ë°±ì—…
        let resizeTimer;
        window.addEventListener("resize", () => {
          clearTimeout(resizeTimer);
          resizeTimer = setTimeout(() => {
            initialize();
          }, 200);
        });
      });
    </script>

    <script>
      $(function () {
        const $slider = $(".mobile-slider");
        const $wrapper = $(".slider-wrapper");
        const $slides = $(".slide");
        const $indicators = $(".slider-indicators");
        const $prevBtn = $(".slider-button.prev");
        const $nextBtn = $(".slider-button.next");

        let currentIndex = 0;
        const totalSlides = $slides.length;
        let startX = 0;
        let currentX = 0;
        let isDragging = false;
        let hasMoved = false; // â­ ì‹¤ì œë¡œ ë“œë˜ê·¸í–ˆëŠ”ì§€ í™•ì¸

        for (let i = 0; i < totalSlides; i++) {
          $indicators.append(
            `<span class="indicator ${
              i === 0 ? "active" : ""
            }" data-index="${i}"></span>`
          );
        }

        function goToSlide(index) {
          if (index < 0) index = 0;
          if (index >= totalSlides) index = totalSlides - 1;

          currentIndex = index;
          const offset = -currentIndex * 100;
          $wrapper.css("transform", `translateX(${offset}%)`);

          $(".indicator").removeClass("active");
          $(`.indicator[data-index="${currentIndex}"]`).addClass("active");
        }

        $prevBtn.on("click", function (e) {
          e.stopPropagation(); // â­ ì´ë²¤íŠ¸ ì „íŒŒ ì°¨ë‹¨
          goToSlide(currentIndex - 1);
        });

        $nextBtn.on("click", function (e) {
          e.stopPropagation(); // â­ ì´ë²¤íŠ¸ ì „íŒŒ ì°¨ë‹¨
          goToSlide(currentIndex + 1);
        });

        $indicators.on("click", ".indicator", function (e) {
          e.stopPropagation(); // â­ ì´ë²¤íŠ¸ ì „íŒŒ ì°¨ë‹¨
          const index = parseInt($(this).data("index"));
          goToSlide(index);
        });

        // â­ ì´ë¯¸ì§€ í´ë¦­ ì´ë²¤íŠ¸ ì°¨ë‹¨
        $(".slide-image").on("click touchend", function (e) {
          if (!hasMoved) {
            e.stopPropagation();
            // ì´ë¯¸ì§€ í´ë¦­ ì‹œ ì›í•˜ëŠ” ë™ì‘ ì¶”ê°€ ê°€ëŠ¥
            console.log("ì´ë¯¸ì§€ í´ë¦­ë¨");
          }
        });

        $slider.on("mousedown touchstart", function (e) {
          // â­ ë²„íŠ¼ì´ë‚˜ ì¸ë””ì¼€ì´í„° í´ë¦­ì€ ë¬´ì‹œ
          if ($(e.target).closest(".slider-button, .indicator").length > 0) {
            return;
          }

          isDragging = true;
          hasMoved = false; // â­ ì´ˆê¸°í™”
          startX =
            e.type === "touchstart"
              ? e.originalEvent.touches[0].clientX
              : e.clientX;
          $wrapper.css("transition", "none");
        });

        $(document).on("mousemove touchmove", function (e) {
          if (!isDragging) return;

          currentX =
            e.type === "touchmove"
              ? e.originalEvent.touches[0].clientX
              : e.clientX;
          const diffX = currentX - startX;

          // â­ 5px ì´ìƒ ì›€ì§ì´ë©´ ë“œë˜ê·¸ë¡œ ì¸ì‹
          if (Math.abs(diffX) > 5) {
            hasMoved = true;
          }

          const offset =
            -currentIndex * 100 + (diffX / window.innerWidth) * 100;
          $wrapper.css("transform", `translateX(${offset}%)`);
        });

        $(document).on("mouseup touchend", function (e) {
          if (!isDragging) return;

          isDragging = false;
          $wrapper.css("transition", "transform 0.3s ease-out");

          const diffX = currentX - startX;
          const threshold = window.innerWidth * 0.2;

          // â­ ì‹¤ì œë¡œ ë“œë˜ê·¸í•œ ê²½ìš°ì—ë§Œ ìŠ¬ë¼ì´ë“œ ë³€ê²½
          if (hasMoved && Math.abs(diffX) > 10) {
            if (diffX > threshold && currentIndex > 0) {
              goToSlide(currentIndex - 1);
            } else if (diffX < -threshold && currentIndex < totalSlides - 1) {
              goToSlide(currentIndex + 1);
            } else {
              goToSlide(currentIndex);
            }
          } else {
            // â­ ë“œë˜ê·¸ ì•ˆ í•¨ = í´ë¦­ â†’ ì›ìœ„ì¹˜
            goToSlide(currentIndex);
          }

          // â­ ë¦¬ì…‹
          hasMoved = false;
        });
      });
    </script>

    <script>
      gsap.registerPlugin(ScrollTrigger);
    </script>
  </body>
</html>
